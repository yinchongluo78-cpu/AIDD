#!/usr/bin/expect -f

set timeout 60

spawn ssh root@120.24.22.244
expect "password:"
send "Lyc001286\r"

expect "root@*"
send "cd /var/www/lyc-ai/api\r"

expect "root@*"
send "npx prisma db execute --stdin <<< 'SELECT d.filename, COUNT(c.id) as chunks FROM kb_documents d LEFT JOIN kb_chunks c ON d.id = c.doc_id GROUP BY d.id, d.filename;'\r"

sleep 5

expect "root@*"
send "exit\r"

expect eof
