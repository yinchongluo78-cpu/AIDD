# 配置模板文档

## 项目恢复检查清单

从 GitHub 标签恢复项目时，需要配置以下文件：

### 1. 后端环境变量 `api/.env`

```env
# 数据库连接（阿里云 RDS）
DATABASE_URL="postgresql://用户名:密码@服务器地址:端口/数据库名"

# JWT 认证密钥
JWT_SECRET="随机生成的长字符串"

# DeepSeek API
DEEPSEEK_API_KEY="sk-xxxxx"

# 阿里云 OCR
ALIYUN_OCR_ACCESS_KEY_ID="LTAI开头的AccessKeyId"
ALIYUN_OCR_ACCESS_KEY_SECRET="密钥"

# 阿里云 OSS（对象存储）
OSS_ACCESS_KEY_ID="LTAI开头的AccessKeyId"
OSS_ACCESS_KEY_SECRET="密钥"
OSS_REGION="oss-cn-shanghai"
OSS_BUCKET="你的Bucket名称"
OSS_ENDPOINT="https://oss-cn-shanghai.aliyuncs.com"
```

### 2. 前端环境变量

#### `web/.env.development` (本地开发)
```env
VITE_API_BASE=http://localhost:3000/api
```

#### `web/.env.production` (线上生产)
```env
VITE_API_BASE=http://120.24.22.244/api
```

### 3. 管理后台环境变量

#### `admin/.env.development`
```env
VITE_API_BASE=http://localhost:3000/api
```

#### `admin/.env.production`
```env
VITE_API_BASE=http://120.24.22.244/api
```

## 恢复步骤

### 步骤 1: 克隆代码
```bash
git clone https://github.com/yinchongluo78-cpu/AIDD.git
cd AIDD
git checkout v2.0-math-rendering
```

### 步骤 2: 创建环境变量文件
根据上面的模板创建所有 `.env` 文件，填入实际的配置值。

### 步骤 3: 安装依赖
```bash
# 后端
cd api
npm install

# 前端
cd ../web
npm install

# 管理后台
cd ../admin
npm install
```

### 步骤 4: 数据库迁移
```bash
cd api
npx prisma db push
```

### 步骤 5: 本地开发测试
```bash
# 启动后端（终端1）
cd api
npm run dev

# 启动前端（终端2）
cd web
npm run dev

# 启动管理后台（终端3）
cd admin
npm run dev
```

### 步骤 6: 生产环境部署
```bash
# 构建后端
cd api
npm run build

# 构建前端
cd web
npm run build

# 构建管理后台
cd admin
npm run build

# 上传到服务器（参考 DEPLOYMENT_PATHS.md）
```

## 关键依赖

### 后端
- Node.js >= 18
- PostgreSQL（阿里云 RDS）
- PM2（进程管理）

### 前端
- Node.js >= 18
- Nginx（Web 服务器）

## 服务器路径（参考）

- 后端代码: `/root/myproject/lyc2/api`
- 前端代码: `/var/www/lyc-ai/web/dist`
- 管理后台: `/var/www/admin`

## 注意事项

⚠️ **安全提醒**：
- 永远不要将 `.env` 文件提交到 Git
- 定期更换 API 密钥和数据库密码
- JWT_SECRET 应该是长随机字符串（建议 64+ 字符）
- 阿里云 AccessKey 应该设置 IP 白名单限制

✅ **备份建议**：
- 定期备份数据库（RDS 自动备份）
- 保存 `.env` 文件到安全的密码管理器
- 重要配置写入此文档（不含实际密钥）
